
<!-- SEARCH -->
<form class="search-bar" action="search" method="get">
    <div class="large-12 columns">
      <div class="row collapse">
        <div class="small-5 columns">
          <input name="search_input" class="search-input" type="text" placeholder="search items">
        </div>
        <div class="small-5 columns">
          <input name="search_location_input" class="search-input" type="text" placeholder="search location">
        </div>
        <div class="small-2 columns">
          <button class="button postfix">search</button>
        </div>
      </div>
    </div>
</form>


<!-- GOOGLE MAP -->
<div class="page-layout">

  
  
  <div class="map-container">
          </div>
    <div class="small-12 large-6 columns">
    	<div class="map" style='width: 100%; height: 600px;'>

    </div>
  </div>

<!-- SEARCH RESULTS -->
<div class="searched-items">
  <div id="result-box" class="small-12 large-6 columns">
    <h2>Search Results</h2>
    <div class="add-result-box">

    <% @result.each do |item| %>
<!-- -------------------------- -->
   <!--  <div id='cover_image' data-id="<%= item.id%>" class="small-4 columns"></div>
    <div class="small-5 columns">
      <a href="#"><h5><%#= item.title %></h5></a>
      <p>$<%#= item.item_details %></p>
    </div>
    <div class="small-3 columns">
      <h5>$<%#= item.price %></h5>
      <p><%#= item.city %></p>
      <p><%#= item.loan_status %></p>
    </div>
    <hr>
  <%# end %> -->
<!-- ------------------------- -->
      <!-- <div id='cover_image' data-id="<%#= item.id%>" class="small-4 columns"></div> -->
      <div class="small-4 columns">
        <% if ItemImage.find_by(item_id: item.id) %>
          <% if ItemImage.find_by(item_id: item.id)[:image_path].nil? %>
            <img src="<%= ItemImage.find_by(item_id: item.id).image_path_backup %>">
          <% else %>
            <img src="<%= ItemImage.find_by(item_id: item.id).image_path %>">
          <% end %>
        <% else %>
          <p>no image</p>
        <% end %>
      </div>
      <div class="small-5 columns">
        <a href="#"><h5><%= item.title %></h5></a>
        <p><%= item.item_details %></p>
      </div>
      <div class="small-3 columns">
        <h5>$<%= item.price %></h5>
        <p><%= item.city %></p>
        <h5 class="<%= item.loan_status == 'available'? 'available' : 'onloan'  %>"><%= item.loan_status %></h5>
      </div>
      <hr>
    <% end %>
  </div>
</div>



</div>


<!-- JavaScript for map -->

<script>

$(document).ready(function(){
  var map = new google.maps.Map($('.map')[0],{
    zoom:5,
    center: {lat: -37.813155, lng:144.964078}
  });

  var infoWindow = new google.maps.InfoWindow({map: map});

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };

      infoWindow.setPosition(pos);
      infoWindow.setContent('Location found.');
      map.setCenter(pos);
    }, function() {
      handleLocationError(true, infoWindow, map.getCenter());
    });
  } else {
    // Browser doesn't support Geolocation
    handleLocationError(false, infoWindow, map.getCenter());
  }

  function handleLocationError(browserHasGeolocation, infoWindow, pos) {
    infoWindow.setPosition(pos);
    infoWindow.setContent(browserHasGeolocation ?
      'Error: The Geolocation service failed.' :
      'Error: Your browser doesn\'t support geolocation.');
  }
});

  // var options = {
  //   url: 'http:/localhost:3000/api/items',
  //   type: 'get',
  //   dataType: 'json'
  // };


  // $.ajax(options).done(function(){
  //   $('.map').append('.');
  // })
</script>
